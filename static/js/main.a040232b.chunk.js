(this.webpackJsonphere=this.webpackJsonphere||[]).push([[0],{31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var o=n(1),s=n.n(o),c=n(24),a=n.n(c),i=(n(31),n(17)),r=n(26),l=n(7),u=n(8),d=n(10),g=n(9),h=(n(32),n(33),n(2)),b=n(12),j=n(16),p=n(0),f=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={redirect:!1},e.statusChangeCallback=function(t){var n=t.status;return console.log(n),new Promise((function(o,s){if("not_authorized"===n||"unknown"===n)return console.log("not connected",window.FB,Object(j.a)(e)),window.FB.login((function(t){return console.log("response",t),e.props.setAccess(t.authResponse.accessToken),o(t.authResponse)}));console.log("connect"),e.props.setAccess(t.authResponse.accessToken),o(t.authResponse)}))},e.checkLoginState=function(){return new Promise((function(e,t){window.FB.getLoginStatus((function(t){e(t)}))}))},e}return Object(u.a)(n,[{key:"loadFbApi",value:function(){return new Promise((function(e,t){!function(e,t,n){var o,s=e.getElementsByTagName(t)[0];e.getElementById(n)||((o=e.createElement(t)).id=n,o.src="//connect.facebook.net/en_US/sdk.js",s.parentNode.insertBefore(o,s))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){window.FB.init({appId:0x661cee00f404d,cookie:!0,xfbml:!0,version:"v9.0"}),window.FB.AppEvents.logPageView(),console.log("fired"),e()}}))}},{key:"componentDidMount",value:function(){var e=this;(console.log("mount",window.FB),window.FB)?(console.log("window exists"),this.checkLoginState.bind(this)().then((function(t){console.log("res1",t),e.statusChangeCallback.bind(e)(t).then((function(t){console.log("res2",t,e.props.accessToken),new Promise((function(e,t){window.FB.api("/me/accounts?fields=id",(function(n){console.log("res",n),n?e():t()}))})).then((function(){e.props.accessToken.length>1&&(console.log("here"),e.setState({redirect:!0}),console.log("redirect",e.state.redirect),setTimeout((function(){e.forceUpdate()}),1e3))}))}))}))):this.loadFbApi().then((function(){e.checkLoginState.bind(e)().then((function(t){console.log("res1 second",t),e.statusChangeCallback.bind(e)(t).then((function(t){console.log("res2 second",t,e.props.accessToken),new Promise((function(e,t){window.FB.api("/me/accounts?fields=id",(function(n){console.log("res",n),n?e():t()}))})).then((function(){e.props.accessToken.length>1&&(console.log("here"),e.setState({redirect:!0}),console.log("redirect",e.state.redirect),setTimeout((function(){e.forceUpdate()}),1e3))}))}))}))}))}},{key:"render",value:function(){var e=this.props.loggedIn,t=this.state.redirect;return console.log("new",e,t),Object(p.jsxs)(s.a.Fragment,{children:[!0===t?Object(p.jsx)(h.a,{to:"/dashboard"}):null,Object(p.jsx)("div",{id:"fb-root",children:Object(p.jsx)("div",{"data-onlogin":function(){return console.log("data login")},className:"fb-login-button","data-width":"300","data-size":"large","data-button-type":"continue_with","data-layout":"default","data-auto-logout-link":"false","data-use-continue-as":"false",scope:"read_insights,instagram_basic,pages_show_list,instagram_manage_comments,instagram_manage_insights,pages_read_engagement"})})]})}}]),n}(s.a.Component),m=n(14),O=n.n(m),v=n(22),x=n(15),w=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={email:"",password:"",submitRedirectFb:!1,invalidLogin:!1,errorMsg:" "},e.handleChange=function(t){e.setState(Object(x.a)({},t.target.id,t.target.value))},e.handleSubmit=function(){var t=e.state,n=t.email,o=t.password;t.invalidLogin;if(n.length>1&&o.length>1){var s={email:n,password:o};fetch("https://multer-test123.herokuapp.com/signin",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then((function(t){return console.log("res",t),200===t.status?(e.setState({invalidLogin:!1}),t.json()):(e.setState({invalidLogin:!0}),t.json())})).then(function(){var t=Object(v.a)(O.a.mark((function t(n){var o,s,c,a,i,r,l,u,d,g;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.Error,console.log(n,e.state.invalidLogin,o),!1!==e.state.invalidLogin||o){t.next=25;break}return"token",s=(new Date).getTime(),c=s+6e4,document.cookie="token="+n.token+";expires="+c+";path=/",a=document.cookie.match(new RegExp("(^| )token=([^;]+)")),i=a[0].split("="),r=i[1],console.log("bearer",r),l=new FormData,t.next=14,fetch("https://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/Image_created_with_a_mobile_phone.png/1200px-Image_created_with_a_mobile_phone.png");case 14:return u=t.sent,t.next=17,u.blob();case 17:d=t.sent,g=new File([d],"test.jpg",{type:"image/jpeg"}),l.append("image",g),console.log("formData",l,g),new Promise((function(t,o){fetch("https://multer-test123.herokuapp.com/test",{method:"POST",body:l,headers:{Authorization:"Bearer ".concat(r)}}).then(function(){var s=Object(v.a)(O.a.mark((function s(c){return O.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(console.log("here",c),200!==c.status){s.next=5;break}t(),s.next=11;break;case 5:if(403!==c.status){s.next=10;break}return s.next=8,c.json();case 8:n=s.sent,e.setState({errorMsg:n.Error});case 10:o();case 11:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()).catch((function(e){return console.log(e)}))})).then((function(){setTimeout((function(){e.setState({submitRedirectFb:!0})}),1e3)})).catch((function(e){return console.log(e)})),t.next=27;break;case 25:console.log("error"),e.setState({errorMsg:n.Error});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}else e.setState({errorMsg:"Please ensure both fields are entered correctly."})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.email,o=t.password,c=t.submitRedirectFb,a=t.invalidLogin,i=t.errorMsg;return Object(p.jsxs)(s.a.Fragment,{children:[!0===c&&!1===a?Object(p.jsx)(h.a,{to:"/fb"}):null,Object(p.jsx)("h1",{children:"Sign In"}),Object(p.jsx)("span",{className:"alert",children:i}),Object(p.jsx)("label",{children:"Email:"}),Object(p.jsx)("input",{id:"email",value:n,onChange:function(t){return e.handleChange(t)},className:"input"}),Object(p.jsx)("label",{children:"Password:"}),Object(p.jsx)("input",{id:"password",value:o,onChange:function(t){return e.handleChange(t)},className:"input"}),Object(p.jsxs)("div",{className:"btnContain",children:[Object(p.jsxs)("button",{onClick:this.handleSubmit,className:"btn login",children:[Object(p.jsxs)("div",{className:"lds-defaultTwo",children:[Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{}),Object(p.jsx)("div",{})]}),Object(p.jsx)("span",{className:"loginTxt",children:"LOGIN"})]}),Object(p.jsx)("button",{className:"btn signup",children:Object(p.jsx)("span",{className:"signTxt",children:" SIGNUP "})})]})]})}}]),n}(s.a.Component);function k(){var e=Object(h.g)(),t=Object(h.h)();return console.log(e,t),Object(p.jsx)("div",{})}var y=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={loggedOut:!1},e.logout=function(){window.FB.logout((function(e){console.log("loggedout",e)})),e.props.redirectPage(!1),setTimeout((function(){e.setState({loggedOut:!0})}),2e3)},e}return Object(u.a)(n,[{key:"render",value:function(){this.state.loggedOut,this.props.accessToken;return console.log("at new",this.props),Object(p.jsxs)(s.a.Fragment,{children:[Object(p.jsx)("button",{onClick:this.logout,children:"Logout"}),Object(p.jsx)(k,{})]})}}]),n}(s.a.Component),S=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={loggedIn:!1,accessToken:""},e.redirectPage=function(t){e.setState({loggedIn:t})},e.setAccess=function(t){e.setState({accessToken:t})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state,t=e.loggedIn,n=e.accessToken,o=function(e){var t=e.component,o=Object(r.a)(e,["component"]);return Object(p.jsx)(h.b,Object(i.a)(Object(i.a)({},o),{},{render:function(e){return n.length>2?Object(p.jsx)(t,Object(i.a)({},e)):Object(p.jsx)(h.a,{to:{pathname:"/",state:{from:e.location}}})}}))};return Object(p.jsx)(b.a,{basename:"/",children:Object(p.jsxs)(h.d,{children:[Object(p.jsx)(h.b,{exact:!0,path:"/",children:Object(p.jsx)("div",{className:"form",children:Object(p.jsx)("div",{className:"rowMine",children:Object(p.jsx)(w,{showBtn:this.showBtn})})})}),Object(p.jsx)(h.b,{path:"/fb",children:Object(p.jsx)("div",{className:"form",children:Object(p.jsx)("div",{className:"rowMine",children:Object(p.jsx)(f,{loggedIn:t,redirectPage:this.redirectPage,setAccess:this.setAccess,accessToken:n})})})}),Object(p.jsx)(o,{component:y,path:"/dashboard",redirectPage:this.redirectPage,accessToken:n})]})})}}]),n}(s.a.Component),T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,o=t.getFID,s=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),o(e),s(e),c(e),a(e)}))};a.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(S,{})}),document.getElementById("root")),T()}},[[41,1,2]]]);
//# sourceMappingURL=main.a040232b.chunk.js.map