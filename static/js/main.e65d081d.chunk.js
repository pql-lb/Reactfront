(this.webpackJsonphere=this.webpackJsonphere||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),c=n(23),r=n.n(c),s=(n(30),n(13)),i=n(25),u=n(9),l=n(10),d=n(12),g=n(11),h=(n(31),n(32),n(2)),f=n(15),p=n(3),b=n.n(p),j=n(7),m=n(0),v=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(u.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={redirect:!1},e.checkLoginState=function(){return new Promise((function(e,t){window.FB.getLoginStatus((function(t){e(t)}))}))},e.login=function(){return new Promise((function(e,t){window.FB.login((function(t){console.log("logged in",t.authResponse.accessToken);var n=t.authResponse.accessToken;e(n)}))}))},e.statusChange=function(t){return new Promise(function(){var n=Object(j.a)(b.a.mark((function n(o,a){return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:"unknown"===t.status||"not_authorized"===t.status?e.login().then((function(t){e.props.redirectPageLogout(!1),e.props.setAccess(t),localStorage.setItem("access",t),o(t)})):(e.props.redirectPageLogout(!1),e.props.setAccess(t.authResponse.accessToken),localStorage.setItem("access",t.authResponse.accessToken),o(t.authResponse.accessToken));case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},e.testAPI=function(){return new Promise((function(e,t){window.FB.getLoginStatus((function(n){console.log(n),window.FB.api("/me/accounts?fields=id",{access_token:n.authResponse.accessToken},(function(n){console.log("RESPONSE",n),n?e():t()}))}))}))},e}return Object(l.a)(n,[{key:"loadFbApi",value:function(){return new Promise((function(e,t){window.FB?e():(!function(e,t,n){var o,a=e.getElementsByTagName(t)[0];e.getElementById(n)||((o=e.createElement(t)).id=n,o.src="//connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(o,a))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){window.FB.init({appId:0x661cee00f404d,cookie:!0,xfbml:!0,version:"v9.0"}),window.FB.AppEvents.logPageView(),console.log("fired"),e()})}))}},{key:"componentDidMount",value:function(){var e=this;document.cookie.match(new RegExp("(^| )token=([^;]+)"))&&this.loadFbApi().then((function(){e.checkLoginState.bind(e)().then(function(){var t=Object(j.a)(b.a.mark((function t(n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.statusChange.bind(e)(n).then((function(t){console.log("a",t),t&&e.testAPI().then((function(){e.props.accessToken.length>1&&(console.log("here"),e.props.redirectPage(!0),console.log("redirect",e.props.login),setTimeout((function(){e.forceUpdate()}),1e3))})).catch((function(e){return console.log("err with test call",e)}))})).catch((function(e){return console.log("err with status change",e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){return console.log("err with check login",e)}))}))}},{key:"render",value:function(){var e=this.props.loggedIn;return console.log("You are on fb page, loggedIn:",e),document.cookie.match(new RegExp("(^| )token=([^;]+)"))?Object(m.jsxs)(a.a.Fragment,{children:[!0===e?Object(m.jsx)(h.a,{to:"/dashboard"}):null,Object(m.jsx)("div",{id:"fb-root",children:Object(m.jsx)("div",{"data-onlogin":function(){return console.log("data login")},className:"fb-login-button","data-width":"300","data-size":"large","data-button-type":"continue_with","data-layout":"default","data-auto-logout-link":"false","data-use-continue-as":"false",scope:"read_insights,instagram_basic,pages_show_list,instagram_manage_comments,instagram_manage_insights,pages_read_engagement"})})]}):Object(m.jsx)("div",{children:"No cookie exists please login first"})}}]),n}(a.a.Component),w=n(16),O=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(u.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={email:"",password:"",submitRedirectFb:!1,invalidLogin:!1,errorMsg:" "},e.handleChange=function(t){e.setState(Object(w.a)({},t.target.id,t.target.value))},e.handleSubmit=function(){var t=e.state,n=t.email,o=t.password;t.invalidLogin;if(n.length>1&&o.length>1){var a={email:n,password:o};fetch("https://multer-test123.herokuapp.com/signin",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((function(t){return console.log("res",t),200===t.status?(e.setState({invalidLogin:!1}),t.json()):(e.setState({invalidLogin:!0}),t.json())})).then(function(){var t=Object(j.a)(b.a.mark((function t(n){var o,a,c,r,s,i,u,l,d,g;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.Error,console.log(n,e.state.invalidLogin,o),!1!==e.state.invalidLogin||o){t.next=25;break}return"token",a=(new Date).getTime(),c=a+6e4,document.cookie="token="+n.token+";expires="+c+";path=/",r=document.cookie.match(new RegExp("(^| )token=([^;]+)")),s=r[0].split("="),i=s[1],console.log("bearer",i),u=new FormData,t.next=14,fetch("https://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/Image_created_with_a_mobile_phone.png/1200px-Image_created_with_a_mobile_phone.png");case 14:return l=t.sent,t.next=17,l.blob();case 17:d=t.sent,g=new File([d],"test.jpg",{type:"image/jpeg"}),u.append("image",g),console.log("formData",u,g),new Promise((function(t,o){fetch("https://multer-test123.herokuapp.com/test",{method:"POST",body:u,headers:{Authorization:"Bearer ".concat(i)}}).then(function(){var a=Object(j.a)(b.a.mark((function a(c){return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(console.log("here",c),200!==c.status){a.next=5;break}t(),a.next=11;break;case 5:if(403!==c.status){a.next=10;break}return a.next=8,c.json();case 8:n=a.sent,e.setState({errorMsg:n.Error});case 10:o();case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){return console.log(e)}))})).then((function(){setTimeout((function(){e.setState({submitRedirectFb:!0})}),1e3)})).catch((function(e){return console.log(e)})),t.next=27;break;case 25:console.log("error"),e.setState({errorMsg:n.Error});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}else e.setState({errorMsg:"Please ensure both fields are entered correctly."})},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.email,o=t.password,c=t.submitRedirectFb,r=t.invalidLogin,s=t.errorMsg;return Object(m.jsxs)(a.a.Fragment,{children:[!0===c&&!1===r?Object(m.jsx)(h.a,{to:"/fb"}):null,Object(m.jsx)("h1",{children:"Sign In"}),Object(m.jsx)("span",{className:"alert",children:s}),Object(m.jsx)("label",{children:"Email:"}),Object(m.jsx)("input",{id:"email",value:n,onChange:function(t){return e.handleChange(t)},className:"input"}),Object(m.jsx)("label",{children:"Password:"}),Object(m.jsx)("input",{id:"password",value:o,onChange:function(t){return e.handleChange(t)},className:"input"}),Object(m.jsxs)("div",{className:"btnContain",children:[Object(m.jsxs)("button",{onClick:this.handleSubmit,className:"btn login",children:[Object(m.jsxs)("div",{className:"lds-defaultTwo",children:[Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{})]}),Object(m.jsx)("span",{className:"loginTxt",children:"LOGIN"})]}),Object(m.jsx)("button",{className:"btn signup",children:Object(m.jsx)("span",{className:"signTxt",children:" SIGNUP "})})]})]})}}]),n}(a.a.Component);function x(e,t,n,o){return 0===e.length?o.join("").split("#"):"#"===e[t]?(o.push(e[t]),e.shift(),x(e,t,!0,o)):"#"!==e[t]?!0===n?(o.push(e[t])," "===e[t+1]|e[t+1==="#"]?(e.shift(),x(e,t,!1,o)):(e.shift(),x(e,t,!0,o))):(e.shift(),x(e,t,!1,o)):void 0}var k=function(e,t,n,o){return new Promise((function(o,a){window.FB.api("".concat(e.id,"?fields=like_count,caption,id"),(function(e){e.like_count;var c=e.like_count,r=String(e.caption),s=Array.from(r);0===(n=x(s,0,!1,t)).length&&a(e),n.shift();var i={id:e.id,likes:c,hashtags:n};"undefined"!==n&&o(i)}))}))};var y=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(u.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={loggedOut:!1},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=[];new Promise((function(e,t){window.FB.api("/me/accounts?fields=id",(function(n){var o=n.data[0].id;window.FB.api("/".concat(o,"?fields=instagram_business_account"),(function(n){var o=n.instagram_business_account.id;window.FB.api("/".concat(o,"/media"),(function(n){var o=n.data;"undefined"!==o?e(o):(t(n),document.querySelector(".alert").innerHTML="An error has occurred, please refresh the page.")}))}))}))})).then((function(t){console.log("res",t),function(e,t,n){return new Promise((function(t,o){e.map(function(){var a=Object(j.a)(b.a.mark((function a(c,r){var s;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=new Array,a.next=3,k(c,s,void 0).then((function(a){"undefined"===a&&o(c),n.push(a),n.length===e.length&&t(n)}));case 3:return a.abrupt("return",a.sent);case 4:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}))}(t,0,e).then((function(e){(function(e,t,n,o){t=n/o.length;var a={};return e.map((function(n,o){var c=n.likes-t;n.difference=c;var r=c/n.hashtags.length;return n.hashtagScore=r,n.hashtags.map((function(e){e in a?a[e]+=1:a=Object(s.a)(Object(s.a)({},a),{},Object(w.a)({},e,1))})),e})),{newDict:e,hashNumUses:a}})(e,undefined,0,t).then((function(e){return console.log("avlikes dictionary",e)}))}))}))}},{key:"render",value:function(){return Object(m.jsx)(a.a.Fragment,{children:Object(m.jsx)("div",{children:"Hashtags"})})}}]),n}(a.a.Component);function P(){return new Promise((function(e,t){window.FB.getLoginStatus((function(t){e(t)}))}))}var S=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(u.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={loggedOut:!1},e.logout=Object(j.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:P().then((function(e){e&&window.FB.logout((function(e){console.log("loggedout",e)}))})),"token","Thu, 01 Jan 1970 00:00:01 GMT",n=document.cookie.match(new RegExp("(^| )token=([^;]+)")),document.cookie="token="+n[0]+";expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/",localStorage.removeItem("access"),e.props.redirectPage(!1),setTimeout((function(){e.props.redirectPageLogout(!0)}),2e3);case 8:case"end":return t.stop()}}),t)}))),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.FB||new Promise((function(e,t){window.FB?e():(function(e,t,n){var o,a=e.getElementsByTagName(t)[0];e.getElementById(n)||((o=e.createElement(t)).id=n,o.src="//connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(o,a))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){window.FB.init({appId:0x661cee00f404d,cookie:!0,xfbml:!0,version:"v9.0"}),window.FB.AppEvents.logPageView(),console.log("fired"),e()})})).then((function(){return P()})).then((function(t){t?(console.log("You are logged in to fb"),e.forceUpdate()):new Error("You are not logged in to fb")})).catch((function(e){return console.log("Component did mount",e)}))}},{key:"render",value:function(){var e=this.props,t=(e.accessToken,e.loggedOut);return console.log("at new",this.props,this.state),Object(m.jsxs)(a.a.Fragment,{children:[!0===t?Object(m.jsx)(h.a,{to:"/"}):null,Object(m.jsx)("button",{onClick:this.logout,children:"Logout"}),Object(m.jsx)("div",{className:"dash",children:window.FB&&Object(m.jsx)(y,{})})]})}}]),n}(a.a.Component),F=function(e){Object(d.a)(n,e);var t=Object(g.a)(n);function n(){var e;Object(u.a)(this,n);for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={loggedIn:!1,accessToken:"",loggedOut:!1},e.redirectPage=function(t){e.setState({loggedIn:t})},e.redirectPageLogout=function(t){e.setState({loggedOut:t})},e.setAccess=function(t){e.setState({accessToken:t})},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state,t=e.loggedIn,n=e.loggedOut,o=e.accessToken,a=document.cookie.match(new RegExp("(^| )token=([^;]+)")),c=localStorage.getItem("access"),r=function(e){var t=e.component,n=Object(i.a)(e,["component"]);return Object(m.jsx)(h.b,Object(s.a)(Object(s.a)({},n),{},{render:function(e){return a&&c?Object(m.jsx)(t,Object(s.a)(Object(s.a)({},e),n)):Object(m.jsx)(h.a,{to:{pathname:"/",state:{from:e.location}}})}}))};return Object(m.jsx)(f.a,{basename:"/",children:Object(m.jsxs)(h.d,{children:[Object(m.jsx)(h.b,{exact:!0,path:"/",children:Object(m.jsx)("div",{className:"form",children:Object(m.jsx)("div",{className:"rowMine",children:Object(m.jsx)(O,{showBtn:this.showBtn})})})}),Object(m.jsx)(h.b,{path:"/fb",children:Object(m.jsx)("div",{className:"form",children:Object(m.jsx)("div",{className:"rowMine",children:Object(m.jsx)(v,{loggedIn:t,redirectPage:this.redirectPage,redirectPageLogout:this.redirectPageLogout,setAccess:this.setAccess,accessToken:o})})})}),Object(m.jsx)(r,{component:S,path:"/dashboard",loggedOut:n,redirectPageLogout:this.redirectPageLogout,redirectPage:this.redirectPage,accessToken:o})]})})}}]),n}(a.a.Component),T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,42)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),o(e),a(e),c(e),r(e)}))};r.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(F,{})}),document.getElementById("root")),T()}},[[40,1,2]]]);
//# sourceMappingURL=main.e65d081d.chunk.js.map